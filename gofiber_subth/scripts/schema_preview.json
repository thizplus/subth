{
  "description": "Video Database Schema - After removing 'code' field",
  "tables": {
    "videos": {
      "description": "Main video table",
      "columns": {
        "id": {
          "type": "UUID",
          "primary_key": true,
          "auto_generate": true
        },
        "thumbnail": {
          "type": "VARCHAR(255)",
          "description": "Path to thumbnail, e.g., /thumbnails/ABF-144.jpg"
        },
        "source_url": {
          "type": "VARCHAR(255)",
          "description": "Original URL from supjav"
        },
        "category_id": {
          "type": "UUID",
          "foreign_key": "categories.id"
        },
        "release_date": {
          "type": "DATE",
          "nullable": true
        },
        "maker_id": {
          "type": "UUID",
          "foreign_key": "makers.id"
        },
        "views": {
          "type": "INTEGER",
          "default": 0
        },
        "auto_tags": {
          "type": "TEXT[]",
          "description": "Array of auto-detected tags"
        },
        "created_at": {
          "type": "TIMESTAMP"
        },
        "updated_at": {
          "type": "TIMESTAMP"
        }
      }
    },
    "video_translations": {
      "description": "Video titles in multiple languages",
      "columns": {
        "id": {
          "type": "UUID",
          "primary_key": true
        },
        "video_id": {
          "type": "UUID",
          "foreign_key": "videos.id"
        },
        "lang": {
          "type": "VARCHAR(5)",
          "description": "Language code: en, th, ja"
        },
        "title": {
          "type": "TEXT",
          "description": "Full title including code, e.g., 'ABF-144 Complete Subjective...'"
        },
        "created_at": {
          "type": "TIMESTAMP"
        },
        "updated_at": {
          "type": "TIMESTAMP"
        }
      },
      "unique_constraint": [
        "video_id",
        "lang"
      ]
    },
    "video_casts": {
      "description": "Many-to-many: videos <-> casts",
      "columns": {
        "video_id": {
          "type": "UUID",
          "foreign_key": "videos.id"
        },
        "cast_id": {
          "type": "UUID",
          "foreign_key": "casts.id"
        }
      }
    },
    "video_tags": {
      "description": "Many-to-many: videos <-> tags",
      "columns": {
        "video_id": {
          "type": "UUID",
          "foreign_key": "videos.id"
        },
        "tag_id": {
          "type": "UUID",
          "foreign_key": "tags.id"
        }
      }
    }
  },
  "data_mapping": {
    "description": "How JSON source data maps to database",
    "source_to_db": {
      "title": "video_translations.title (lang='en')",
      "url": "videos.source_url",
      "thumbnail/full_image": "videos.thumbnail (as /thumbnails/{code}.jpg)",
      "date": "videos.release_date",
      "views": "videos.views",
      "category": "videos.category_id (via categories table)",
      "maker": "videos.maker_id (via makers table)",
      "cast": "video_casts (via casts table)",
      "tags": "video_tags (via tags table)",
      "code": "NOT STORED - extracted from title when needed"
    }
  },
  "sample_data": [
    {
      "source_json": {
        "code": "KBMS-172",
        "title": "KBMS-172 Even Women Fart.",
        "url": "https://supjav.com/291545.html",
        "thumbnail": "https://img.supjav.com/images/2024/08/kbms172pl.jpg!320x216.jpg",
        "full_image": "https://img.supjav.com/images/2024/08/kbms172pl.jpg",
        "date": "2024/08/24",
        "views": 11732,
        "category": "Censored JAV",
        "maker": "1113 Koubou / Mousouzoku",
        "cast": [],
        "tags": [
          "Fetish"
        ]
      },
      "stored_in_db": {
        "videos": {
          "id": "<auto-generated UUID>",
          "thumbnail": "/thumbnails/KBMS-172.jpg",
          "source_url": "https://supjav.com/291545.html",
          "category_id": "<UUID of category>",
          "release_date": "2024-08-24",
          "maker_id": "<UUID of maker>",
          "views": 11732,
          "auto_tags": [],
          "created_at": "<current timestamp>",
          "updated_at": "<current timestamp>"
        },
        "video_translations": [
          {
            "id": "<auto-generated UUID>",
            "video_id": "<video UUID>",
            "lang": "en",
            "title": "KBMS-172 Even Women Fart.",
            "created_at": "<current timestamp>",
            "updated_at": "<current timestamp>"
          }
        ],
        "video_casts": [],
        "video_tags": [
          {
            "video_id": "<video UUID>",
            "tag_id": "<UUID of 'Fetish'>"
          }
        ]
      },
      "note": "Code is NOT stored separately - it's part of the title"
    },
    {
      "source_json": {
        "code": "KTRA-657",
        "title": "KTRA-657 Slippery And Shiny! Beautiful Girls’ Naughty Oil Sex 2 4 Hours",
        "url": "https://supjav.com/291552.html",
        "thumbnail": "https://img.supjav.com/images/2024/08/ktra657pl.jpg!320x216.jpg",
        "full_image": "https://img.supjav.com/images/2024/08/ktra657pl.jpg",
        "date": "2024/08/24",
        "views": 7930,
        "category": "Censored JAV",
        "maker": "Ke- . Toraibu",
        "cast": [
          "Hoshina Ai",
          "Ichikawa Ema",
          "Kawahara Kaede",
          "Kirari Sena",
          "Kiritani Nao",
          "Sakuma Emi"
        ],
        "tags": [
          "4HR+",
          "Beautiful Girl",
          "Best&Omnibus",
          "Fetish",
          "Lotion"
        ]
      },
      "stored_in_db": {
        "videos": {
          "id": "<auto-generated UUID>",
          "thumbnail": "/thumbnails/KTRA-657.jpg",
          "source_url": "https://supjav.com/291552.html",
          "category_id": "<UUID of category>",
          "release_date": "2024-08-24",
          "maker_id": "<UUID of maker>",
          "views": 7930,
          "auto_tags": [],
          "created_at": "<current timestamp>",
          "updated_at": "<current timestamp>"
        },
        "video_translations": [
          {
            "id": "<auto-generated UUID>",
            "video_id": "<video UUID>",
            "lang": "en",
            "title": "KTRA-657 Slippery And Shiny! Beautiful Girls’ Naughty Oil Sex 2 4 Hours",
            "created_at": "<current timestamp>",
            "updated_at": "<current timestamp>"
          }
        ],
        "video_casts": [
          {
            "video_id": "<video UUID>",
            "cast_id": "<UUID of 'Hoshina Ai'>"
          },
          {
            "video_id": "<video UUID>",
            "cast_id": "<UUID of 'Ichikawa Ema'>"
          },
          {
            "video_id": "<video UUID>",
            "cast_id": "<UUID of 'Kawahara Kaede'>"
          },
          {
            "video_id": "<video UUID>",
            "cast_id": "<UUID of 'Kirari Sena'>"
          },
          {
            "video_id": "<video UUID>",
            "cast_id": "<UUID of 'Kiritani Nao'>"
          },
          {
            "video_id": "<video UUID>",
            "cast_id": "<UUID of 'Sakuma Emi'>"
          }
        ],
        "video_tags": [
          {
            "video_id": "<video UUID>",
            "tag_id": "<UUID of '4HR+'>"
          },
          {
            "video_id": "<video UUID>",
            "tag_id": "<UUID of 'Beautiful Girl'>"
          },
          {
            "video_id": "<video UUID>",
            "tag_id": "<UUID of 'Best&Omnibus'>"
          },
          {
            "video_id": "<video UUID>",
            "tag_id": "<UUID of 'Fetish'>"
          },
          {
            "video_id": "<video UUID>",
            "tag_id": "<UUID of 'Lotion'>"
          }
        ]
      },
      "note": "Code is NOT stored separately - it's part of the title"
    },
    {
      "source_json": {
        "code": "KTRA-656",
        "title": "KTRA-656 Beautiful Girls’ Big Tits Special 4 Hours",
        "url": "https://supjav.com/291551.html",
        "thumbnail": "https://img.supjav.com/images/2024/08/ktra656pl.jpg!320x216.jpg",
        "full_image": "https://img.supjav.com/images/2024/08/ktra656pl.jpg",
        "date": "2024/08/24",
        "views": 10734,
        "category": "Censored JAV",
        "maker": "Ke- . Toraibu",
        "cast": [
          "Ayase Kokoro",
          "Hiwasa Momoka",
          "Kawaguchi Hasumi",
          "Okonogi Hinano",
          "Satsuki Mei"
        ],
        "tags": [
          "4HR+",
          "Beautiful Girl",
          "Best&Omnibus",
          "Big Tits",
          "Titty Fuck"
        ]
      },
      "stored_in_db": {
        "videos": {
          "id": "<auto-generated UUID>",
          "thumbnail": "/thumbnails/KTRA-656.jpg",
          "source_url": "https://supjav.com/291551.html",
          "category_id": "<UUID of category>",
          "release_date": "2024-08-24",
          "maker_id": "<UUID of maker>",
          "views": 10734,
          "auto_tags": [],
          "created_at": "<current timestamp>",
          "updated_at": "<current timestamp>"
        },
        "video_translations": [
          {
            "id": "<auto-generated UUID>",
            "video_id": "<video UUID>",
            "lang": "en",
            "title": "KTRA-656 Beautiful Girls’ Big Tits Special 4 Hours",
            "created_at": "<current timestamp>",
            "updated_at": "<current timestamp>"
          }
        ],
        "video_casts": [
          {
            "video_id": "<video UUID>",
            "cast_id": "<UUID of 'Ayase Kokoro'>"
          },
          {
            "video_id": "<video UUID>",
            "cast_id": "<UUID of 'Hiwasa Momoka'>"
          },
          {
            "video_id": "<video UUID>",
            "cast_id": "<UUID of 'Kawaguchi Hasumi'>"
          },
          {
            "video_id": "<video UUID>",
            "cast_id": "<UUID of 'Okonogi Hinano'>"
          },
          {
            "video_id": "<video UUID>",
            "cast_id": "<UUID of 'Satsuki Mei'>"
          }
        ],
        "video_tags": [
          {
            "video_id": "<video UUID>",
            "tag_id": "<UUID of '4HR+'>"
          },
          {
            "video_id": "<video UUID>",
            "tag_id": "<UUID of 'Beautiful Girl'>"
          },
          {
            "video_id": "<video UUID>",
            "tag_id": "<UUID of 'Best&Omnibus'>"
          },
          {
            "video_id": "<video UUID>",
            "tag_id": "<UUID of 'Big Tits'>"
          },
          {
            "video_id": "<video UUID>",
            "tag_id": "<UUID of 'Titty Fuck'>"
          }
        ]
      },
      "note": "Code is NOT stored separately - it's part of the title"
    }
  ]
}